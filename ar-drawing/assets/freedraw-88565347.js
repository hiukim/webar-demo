import{G as D,R as H}from"./GLTFLoader-48ae2cff.js";new URL(""+new URL("target-test-64716068.png",import.meta.url).href,self.location).href;const _=new URL(""+new URL("target-8e22a3fe.zpt",import.meta.url).href,self.location).href,z=[new URL(""+new URL("apple-bbb6e0d8.glb",import.meta.url).href,self.location).href,new URL(""+new URL("bed-e0cad8b4.glb",import.meta.url).href,self.location).href,new URL(""+new URL("cat-42404867.glb",import.meta.url).href,self.location).href,new URL(""+new URL("dog-3c67a1e6.glb",import.meta.url).href,self.location).href,new URL(""+new URL("eye-60a93634.glb",import.meta.url).href,self.location).href,new URL(""+new URL("fish-181a6a29.glb",import.meta.url).href,self.location).href,new URL(""+new URL("grass-ec471705.glb",import.meta.url).href,self.location).href,new URL(""+new URL("hand-34de7a76.glb",import.meta.url).href,self.location).href,new URL(""+new URL("icecream-0872d269.glb",import.meta.url).href,self.location).href,new URL(""+new URL("jacket-3c005550.glb",import.meta.url).href,self.location).href,new URL(""+new URL("unknown-3e679ade.glb",import.meta.url).href,self.location).href],L=tfc,A="model/tensorflowjs_model.pb",N="model/weights_manifest.json",v="image_1",F="probabilities",k=["apple","bed","cat","dog","eye","fish","grass","hand","icecream","jacket","unknown"],C=[],b=[{scale:.005},{scale:.2},{scale:.5},{scale:.4},{scale:1},{scale:8},{scale:.01},{scale:.8},{scale:.2},{scale:.2,rotate:[Math.PI/2,0,0]},{scale:.2,rotate:[Math.PI/2,0,0]}],u=[];let P,I;const G=(e,l)=>new Promise(s=>{const f=z[l];e.load(f,c=>{s(c)})}),O=e=>{const l=e.getContext("2d"),s=l.getImageData(0,0,e.width,e.height),f=n=>{let t=0;for(let o=0;o<3;o++)t+=s.data[n*4+o];return t/=3,t};let c=0;for(let n=0;n<e.width*e.height;n++)c+=f(n);c/=e.width*e.height;for(let n=0;n<e.width*e.height;n++){const t=f(n);let o=255;t>c&&(o=0);for(let a=0;a<3;a++)s.data[n*4+a]=o}l.putImageData(s,0,0)},Z=async e=>{const l=parseInt(e.width*.2),s=parseInt(e.height*.2),f=parseInt(e.width*.6),c=parseInt(e.height*.6),n=28,t=28,o=document.createElement("canvas"),a=o.getContext("2d");a.canvas.width=n,a.canvas.height=t,a.drawImage(e,l,s,f,c,0,0,n,t),O(o);const p=a.getImageData(0,0,n,t);return document.body.appendChild(a.canvas),L.tidy(()=>{const g=L.fromPixels(p,1).toFloat(),R=L.div(g,L.scalar(255)).expandDims(0),d=P.execute({[v]:R},F).dataSync(),m=d.indexOf(Math.max(...d)),U=k[m];return console.log("recognized: ",m,U,d[m]),d[m]<.5?10:m})};window.addEventListener("DOMContentLoaded",async e=>{const l=window.location.href,s=l.substring(0,l.lastIndexOf("/")+1),f=s+A,c=s+N;P=await tf_converter.loadFrozenModel(f,c);const n=new ZapparThree.LoadingManager,t=new THREE.WebGLRenderer({preserveDrawingBuffer:!0});document.body.appendChild(t.domElement),t.setSize(window.innerWidth,window.innerHeight),window.addEventListener("resize",()=>{t.setSize(window.innerWidth,window.innerHeight)});const o=new ZapparThree.Camera;ZapparThree.glContextSet(t.getContext());const a=new THREE.Scene;a.background=o.backgroundTexture,ZapparThree.permissionRequestUI().then(r=>{r?o.start():ZapparThree.permissionDeniedUI()});const p=new ZapparThree.ImageTrackerLoader(n).load(_),g=new ZapparThree.ImageAnchorGroup(o,p);a.add(g);const T=new D;for(let r=0;r<k.length;r++){const h=await G(T,r),E=new THREE.AnimationMixer(h.scene);h.animations.forEach(w=>{const M=E.clipAction(w);M.loop=THREE.LoopRepeat,M.play()});const i=h.scene;if(i.rotation.set(Math.PI/2,-Math.PI/2,0),i.position.set(0,0,0),b[r].scale){const w=b[r].scale;i.scale.set(w,w,w)}b[r].rotate&&i.rotation.set(...b[r].rotate),i.visible=!1,C[r]=E,u[r]=i,g.add(i)}const R=new THREE.AmbientLight(4210752,2);a.add(R);const x=new THREE.HemisphereLight(16777215,12303359,1);a.add(x);let d=!1;p.onVisible.bind(r=>{setTimeout(()=>{d=!0},500)}),p.onNotVisible.bind(r=>{d=!1;for(let h=0;h<u.length;h++)u[h].visible=!1});const m=new H(o,t);t.setAnimationLoop(y);const U=new THREE.Clock;function y(){const r=U.getDelta();if(I&&I.update(r),o.updateFrame(t),t.render(a,o),d){d=!1;const h=m.capture(g);Z(h).then(i=>{console.log("item INdex",i),u[i]&&(u[i].visible=!0,I=C[i])})}}});
